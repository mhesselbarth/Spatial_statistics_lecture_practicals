<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Wiegand, Getzin, Hesselbarth" />


<title>Cluster processes / Mark correlation function / Heterogenous conditions</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Spatial statistics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="data.html">
    <span class="fa fa-database"></span>
     
    Data
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-tasks"></span>
     
    Practicals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Practical_homo_1.html">
        <span class="fa fa-tasks"></span>
         
        Practical 1
      </a>
    </li>
    <li>
      <a href="Practical_homo_2.html">
        <span class="fa fa-tasks"></span>
         
        Practical 2
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-check"></span>
     
    Solutions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Solution_homo_1.html">
        <span class="fa fa-clipboard-check"></span>
         
        Solution 1
      </a>
    </li>
    <li>
      <a href="Solution_homo_2.html">
        <span class="fa fa-clipboard-check"></span>
         
        Solution 2
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-plus-square"></span>
     
    Additional material
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
        <span class="fa fa-tasks"></span>
         
        Practicals
      </a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="Practical_1st_order.html">
            <span class="fa fa-tasks"></span>
             
            1st order properties
          </a>
        </li>
        <li>
          <a href="Practical_cluster.html">
            <span class="fa fa-tasks"></span>
             
            Advanced SPPA
          </a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
        <span class="fa fa-check"></span>
         
        Solutions
      </a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="Solution_1st_order.html">
            <span class="fa fa-clipboard-check"></span>
             
            1st order properties
          </a>
        </li>
        <li>
          <a href="Solution_cluster.html">
            <span class="fa fa-clipboard-check"></span>
             
            Advanced SPPA
          </a>
        </li>
        <li>
          <a href="Solution_Programita.html">
            <span class="fa fa-clipboard-check"></span>
             
            Solution Programita
          </a>
        </li>
      </ul>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-ellipsis-h"></span>
     
    More...
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://mhesselbarth.rbind.io">
        <span class="fa fa-user"></span>
         
        Contact
      </a>
    </li>
    <li>
      <a href="https://github.com/r-spatialecology/">
        <span class="fa fa-github fa-lg"></span>
         
        Github
      </a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Cluster processes / Mark correlation function / Heterogenous conditions</h1>
<h4 class="author">Wiegand, Getzin, Hesselbarth</h4>
<h4 class="date">Summer semester 2020</h4>

</div>


<p><br></p>
<div id="cluster-process" class="section level1">
<h1>Cluster process</h1>
<p>For more information, please see <em>SpatStat06_Homo.pptx</em>, Slides 9 - 28</p>
<div id="exercise-1" class="section level3">
<h3>Exercise 1)</h3>
<p>Perform a point-pattern analysis on the <em>Hemlock_Adults_vs_SmallSaps.dat</em> data set using CSR as null model. We are now especially interested in pattern 2, the small saplings. Using a cell size of 1 meter, calculate the <span class="math inline">\(O_{22}(r)\)</span>. Up to which scale do we find significant clustering of the saplings?</p>
</div>
<div id="exercise-2" class="section level3">
<h3>Exercise 2)</h3>
<p>Programita is a little quirky when it comes to use a cluster null model on the second pattern. Therefore, uncheck ‘Change patterns’, choose ‘Cluster Process’, check ‘Change pattern’ again and in the new window choose ‘Univar. cluster’ and click ok.</p>
<p>Choose ‘optimize -&gt; g-function’ (since we are only interested into the O-ring statistic here) and press fit. Programita now tries to estimate optimal values for <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\rho\)</span>. The success can be assessed by looking at the upper left plot, where the red line should match the black one. You might obtain a better fit if you click ‘Zoom’ and fit a few times until the fitted parameters stop changing. Once you are satisfied with the fit, press ok and run ‘Calculate index’.</p>
</div>
<div id="exercise-3" class="section level3">
<h3>Exercise 3)</h3>
<p>If the <span class="math inline">\(O_{11}(r)\)</span> function falls into the new envelope, you fitted good parameters for the cluster process. You can review them by clicking ‘Parameter’. Here, the typical cluster size and number of parents are given.</p>
</div>
<div id="exercise-4." class="section level3">
<h3>Exercise 4.)</h3>
<p>Looking at the pattern of adult trees and saplings, is the fitted value for the number of parents realistic? If not so, what could be the reason?</p>
</div>
</div>
<div id="mark-correlation-function-stoyans-k_mm" class="section level1">
<h1>Mark correlation function (Stoyan’s <span class="math inline">\(k_{mm}\)</span>)</h1>
<p>For more information, please see <em>SpatStat06_Homo_NullModels_Marked.pptx</em>, Slides 35 – 49</p>
<div id="exercise-1-1" class="section level3">
<h3>Exercise 1)</h3>
<p>The data set <em>Alive_DouglasFir_OGN.dat</em> contains the location and stem diameters (diameter at breast height, DBH) for all live Douglas fir trees in the Old-growth North plot.</p>
<p>Choose ‘Mark correlation function’ and check ‘List with coordinates, no grid’ and set the bin width to 0.5 (giving you a ring width of 1 meter). Also check the ‘Edge correction’ box to avoid edge effects. ‘Click Calculate index’. What do these results suggest?</p>
</div>
<div id="exercise-2-1" class="section level3">
<h3>Exercise 2)</h3>
<p>Check Calculate ‘simulation envelopes’ to test for significance. As a null model use ‘Marks pat 1 and 2 random’, which is the only appropriate model here, because we look only at one type of points. What could be a possible ecological explanation of your results?</p>
</div>
</div>
<div id="inhomogeneous-point-patterns" class="section level1">
<h1>Inhomogeneous point patterns</h1>
<p>For more information, please see <em>SpatStat07_Hetero.pptx</em>.</p>
<div id="exercise-1-2" class="section level3">
<h3>Exercise 1)</h3>
<p>In the data set <em>Hemlock_Adults_vs_SmallSaps.dat</em>, you can observe a clear gradient in the density of adult trees. Calculate <span class="math inline">\(O_{11}(r)\)</span> and <span class="math inline">\(L_{11}(r)\)</span> for pattern 1 (adult trees) to see up to which scale clustering of the trees can be observed using CSR as null model.</p>
</div>
<div id="exercise-2-slides-32-ff." class="section level3">
<h3>Exercise 2) Slides 32 ff.</h3>
<p>Getzin et al. (2008) show that the study area is heterogenous. We are going to account for this heterogeneity by fitting a heterogeneous Poisson processes. Check the ‘Heterogeneous Poisson box’ and click OK in the opening window. Press ‘Calculate index’. Programita will now estimate <span class="math inline">\(\lambda(x,y)\)</span> and show you a map of the results. The gradient should be well visible.</p>
</div>
<div id="exercise-3-slides-32-ff." class="section level3">
<h3>Exercise 3) Slides 32 ff.</h3>
<p>Press OK in the message box and observe how Programita generates Poisson-processes that follow the estimated density map. Does <span class="math inline">\(O_{11}(r)\)</span> now fit into the simulation envelope? How do you interpret the result?</p>
<p><img src="Practical_cluster_files/figure-html/p_3_plot_example-1.png" width="960" style="display: block; margin: auto;" /></p>
<div id="literature" class="section level4">
<h4>Literature:</h4>
<p>Getzin, S., Wiegand, T., Wiegand, K., He, F., 2008. Heterogeneity influences spatial patterns and demographics in forest stands. J. Ecol. 96, 807–820</p>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
