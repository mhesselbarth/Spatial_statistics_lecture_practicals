<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Wiegand, Getzin, Hesselbarth" />


<title>Cluster processes / Mark correlation function / Heterogenous conditions</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Spatial statistics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-question"></span>
     
    About
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-tasks"></span>
     
    Practicals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Practical_homo_1.html">
        <span class="fa fa-tasks"></span>
         
        Practical 1
      </a>
    </li>
    <li>
      <a href="Practical_homo_2.html">
        <span class="fa fa-tasks"></span>
         
        Practical 2
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-check"></span>
     
    Solutions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Solution_homo_1.html">
        <span class="fa fa-clipboard-check"></span>
         
        Solution 1
      </a>
    </li>
    <li>
      <a href="Solution_homo_2.html">
        <span class="fa fa-clipboard-check"></span>
         
        Solution 2
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-plus-square"></span>
     
    Additional material
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
        <span class="fa fa-tasks"></span>
         
        Practicals
      </a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="Practical_1st_order.html">
            <span class="fa fa-tasks"></span>
             
            1st order properties
          </a>
        </li>
        <li>
          <a href="Practical_cluster.html">
            <span class="fa fa-tasks"></span>
             
            Advanced SPPA
          </a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
        <span class="fa fa-check"></span>
         
        Solutions
      </a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="Solution_1st_order.html">
            <span class="fa fa-clipboard-check"></span>
             
            1st order properties
          </a>
        </li>
        <li>
          <a href="Solution_cluster.html">
            <span class="fa fa-clipboard-check"></span>
             
            Advanced SPPA
          </a>
        </li>
      </ul>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-ellipsis-h"></span>
     
    More...
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://mhesselbarth.rbind.io">
        <span class="fa fa-user"></span>
         
        Contact
      </a>
    </li>
    <li>
      <a href="https://github.com/r-spatialecology/">
        <span class="fa fa-github fa-lg"></span>
         
        Github
      </a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Cluster processes / Mark correlation function / Heterogenous conditions</h1>
<h4 class="author">Wiegand, Getzin, Hesselbarth</h4>
<h4 class="date">Summer semester 2020</h4>

</div>


<p><img src="logo.png" width="182" style="display: block; margin: auto;" /></p>
<p>As always, we load all needed packages.</p>
<pre class="r"><code>  library(spatstat)
  library(tidyverse)</code></pre>
<div id="cluster-process" class="section level1">
<h1>Cluster process</h1>
<div id="exercise-1" class="section level3">
<h3>Exercise 1</h3>
<p><strong>Task:</strong> Perform a point-pattern analysis on the <em>Hemlock_Adults_vs_SmallSaps.txt</em> data set using ‘CSR’ as null model. We are now especially interested in pattern 2, the small saplings. Using a cell size of 1 meter, calculate the O22(r). Up to which scale do we find significant clustering of the saplings?</p>
<p>We import the data first and convert it as <code>ppp</code>. Also, we reclassify the marks as 1 == ‘adults’ and 2 == ‘saplings’.</p>
<pre class="r"><code>  hemlock &lt;- read_delim(file = &quot;Data/Hemlock_Adults_vs_SmallSaps.txt&quot;, 
                        delim = &quot;;&quot;)
  
  hemlock &lt;- mutate(hemlock,
                    mark = case_when(mark == 1 ~ &quot;adults&quot;,
                                     mark == 2 ~ &quot;saplings&quot;),
                    mark = as.factor(mark))
  
  plot_area &lt;- ripras(x = hemlock$x, y = hemlock$y, shape = &quot;rectangle&quot;)
  
  hemlock_ppp &lt;- as.ppp(X = hemlock, W = plot_area)
  
  summary(hemlock_ppp)
## Marked planar point pattern:  427 points
## Average intensity 0.06190762 points per square unit
## 
## Coordinates are given to 2 decimal places
## i.e. rounded to the nearest multiple of 0.01 units
## 
## Multitype:
##          frequency proportion  intensity
## adults         234  0.5480094 0.03392596
## saplings       193  0.4519906 0.02798167
## 
## Window: rectangle = [1.22493, 80.43507] x [-1.64345, 85.43345] units
##                     (79.21 x 87.08 units)
## Window area = 6897.37 square units</code></pre>
<p><img src="Solution_cluster_files/figure-html/s_3_plot_data-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Then, we implement the O-ring statistic.</p>
<pre class="r"><code>  Oest &lt;- function(input, r = NULL, 
                   correction = &quot;Ripley&quot;, divisor = &quot;d&quot;, ...){
    
    p_fct &lt;- pcf(input, r = r,
                 correction = correction, 
                 divisor = divisor)
    
    lambda &lt;- intensity(unmark(input))
    
    eval.fv(p_fct*lambda)
  }</code></pre>
<p>We are just interested in the saplings, therefore we subset them first. Then we calculate the O-ring statistic with simulation envelopes and ‘CSR’ as null model.</p>
<pre class="r"><code>  saplings &lt;- subset.ppp(hemlock_ppp, marks == &quot;saplings&quot;, drop = TRUE)
  
  o_ring_saplings &lt;- envelope(saplings, fun = Oest,
                              r = seq(from = 0, to = 45, by = 0.5), 
                              nsim = 199, nrank = 5)</code></pre>
<p><img src="Solution_cluster_files/figure-html/s_3_plot_subset-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="exercise-2" class="section level3">
<h3>Exercise 2</h3>
<p><strong>Task:</strong> Use the pair-correlation function to fit a cluster process to the data and use the fitted model to simulate null model data</p>
<p>We use the function <code>kkpm()</code> to fit a cluster point process model. We need to provide the point pattern (<code>X</code>, here we need to remove all marks with <code>unmark()</code> because <code>subset.ppp()</code> only drops all unused levels, but does not remove all marks). We specify the cluster type we want to fit (<code>cluster</code>) and which summary function to use (<code>pcf</code>). Then, we simulate patterns using the fitted process with <code>simulate.kppm()</code>. We need to provide the model (<code>object</code>) and the number of simulations (<code>nsim</code>). The result is a list of simulated patterns.</p>
<pre class="r"><code>  thomas_process &lt;- kppm(X = unmark(saplings), clusters = &quot;Thomas&quot;, 
                         statistic = &quot;pcf&quot;)
  
  simulated_pattern &lt;- simulate.kppm(object = thomas_process, nsim = 199)</code></pre>
<p>Now, we can compute the envelopes of the null model and compare it to the observed data.</p>
<pre class="r"><code>  o22_saplings_thomas &lt;- envelope(saplings, fun = Oest, 
                                  r = seq(from = 0, to = 45, by = 0.5),
                                  nsim = 199, nrank = 5, 
                                  simulate = simulated_pattern)</code></pre>
<p><img src="Solution_cluster_files/figure-html/s_3_plot_thomas-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="exercise-3" class="section level3">
<h3>Exercise 3</h3>
<p><strong>Task:</strong> If the function of the observed data falls into the new envelope, you fitted good parameters for the cluster process. You can review them by inspecting the object. Here, the typical cluster size and number of parents are given.</p>
<p><code>kappa</code> is the intensity of cluster centers. In order to get the ‘number of parents’, we need to multiply the number with the area of the observation window (remember: the intensity is the number per unit area). Luckily, <code>spatstat</code> contains a function (<code>area()</code>) to calculate the area. The <code>scale</code> parameter gives the standard deviation of random displacement of a point from its cluster center. To calculate the area of a cluster, we need to calculate the area of the according ‘circle’. The <code>Mean cluster size</code> gives exactly what it says.</p>
<pre class="r"><code>  print(thomas_process)
## Stationary cluster point process model
## Fitted to point pattern dataset &#39;unmark(saplings)&#39;
## Fitted by minimum contrast
##  Summary statistic: pair correlation function
## 
## Uniform intensity:   0.02798167
## 
## Cluster model: Thomas process
## Fitted cluster parameters:
##        kappa        scale 
## 0.0007933329 2.9586691460 
## Mean cluster size:  35.27102 points</code></pre>
<pre><code>## [1] &quot;Number of parents: 5.47&quot;
## [1] &quot;Cluster area: 27.5&quot;</code></pre>
</div>
</div>
<div id="mark-correlation-function-stoyans-k_mm" class="section level1">
<h1>Mark correlation function (Stoyan’s <span class="math inline">\(k_{mm}\)</span>)</h1>
<div id="exercise-1-1" class="section level3">
<h3>Exercise 1</h3>
<p><strong>Task:</strong> The data set <em>Alive_DouglasFir_OGN.txt</em> contains the location and stem diameters (diameter at breast height, DBH) for all living Douglas fir trees in the Old-growth North plot. Calculate the mark correlation function. What do these results suggest?</p>
<p>First, we need to import the data, convert them as <code>ppp</code> object and have a look at the data. This time, the marks are continuous, i.e. the diameter at breast height in cm of each tree. Therefore, the <code>summary()</code> function automatically gives the mean, median and quantiles of the data. Also, the plot automatically scales the point according to their size.</p>
<pre class="r"><code>  douglas_fir &lt;- read_delim(file = &quot;Data/Alive_DouglasFir_OGN.txt&quot;, 
                            delim = &quot;;&quot;)
  
  plot_area &lt;- ripras(x = douglas_fir$x, y = douglas_fir$y, 
                      shape = &quot;rectangle&quot;)
  
  douglas_fir_ppp &lt;- as.ppp(X = douglas_fir, W = plot_area)
  
  summary(douglas_fir_ppp)
## Marked planar point pattern:  335 points
## Average intensity 0.03662751 points per square unit
## 
## Coordinates are given to 2 decimal places
## i.e. rounded to the nearest multiple of 0.01 units
## 
## marks are numeric, of type &#39;double&#39;
## Summary:
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.90   35.60   48.80   46.05   57.90   99.00 
## 
## Window: rectangle = [-0.28027, 103.97027] x [0.04889, 87.78111] units
##                     (104.3 x 87.73 units)
## Window area = 9146.13 square units</code></pre>
<p><img src="Solution_cluster_files/figure-html/s_3_plot_snd_data-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The mark-correlation function can be calculated with <code>markcorr()</code>. This is very straightforward.</p>
<pre class="r"><code>  mark_corrlation_douglas_fir &lt;- markcorr(X = douglas_fir_ppp, 
                                          r = seq(from = 0, to = 45,
                                                  by = 0.5),
                                          correction = &quot;Ripley&quot;)</code></pre>
<p><img src="Solution_cluster_files/figure-html/s_3_plot_mark_correlation-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="exercise-2-1" class="section level3">
<h3>Exercise 2</h3>
<p><strong>Task:</strong> Check Calculate simulation envelopes to test for significance. What could be a possible ecological explanation of your results?</p>
<p>We use <code>envelope()</code> to calculate the simulation envelopes. As null model, we use random labeling, shuffling only the marks but not the points (<code>simulate</code> argument using <code>rlabel()</code>).</p>
<pre class="r"><code>  envelopes_mark_correlation_alive &lt;- envelope(Y = douglas_fir_ppp, 
                                               fun = markcorr,
                                               r = seq(from = 0, to = 45, 
                                                       by = 0.5),
                                               nsim = 199, nrank = 5,
                                               simulate = expression(rlabel(douglas_fir_ppp)))</code></pre>
<p><img src="Solution_cluster_files/figure-html/s_3_plot_envelopes_mark_correlation-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="inhomogeneous-point-patterns" class="section level1">
<h1>Inhomogeneous point patterns</h1>
<div id="exercise-1-2" class="section level3">
<h3>Exercise 1</h3>
<p><strong>Task:</strong> In the data set <em>Hemlock_Adults_vs_SmallSaps.txt</em>, you can observe a clear gradient in the density of adult trees. Calculate O11(r) and L11(r) for pattern 1 (adult trees) to see up to which scale clustering of the trees can be observed using ‘CSR’ as null model.</p>
<p>We import the data, classify it and convert it as <code>ppp</code> object. We plot the point pattern of only adult trees and have a look at the summary.</p>
<pre class="r"><code>  hemlock &lt;- read_delim(file = &quot;Data/Hemlock_Adults_vs_SmallSaps.txt&quot;, 
                        delim = &quot;;&quot;)
  
  hemlock &lt;- mutate(hemlock,
                    mark = case_when(mark == 1 ~ &quot;adults&quot;,
                                     mark == 2 ~ &quot;saplings&quot;),
                    mark = as.factor(mark))
  
  plot_area &lt;- ripras(x = hemlock$x, y = hemlock$y, 
                      shape = &quot;rectangle&quot;)
  
  hemlock_ppp &lt;- as.ppp(X = hemlock, W = plot_area)
  
  summary(hemlock_ppp)
## Marked planar point pattern:  427 points
## Average intensity 0.06190762 points per square unit
## 
## Coordinates are given to 2 decimal places
## i.e. rounded to the nearest multiple of 0.01 units
## 
## Multitype:
##          frequency proportion  intensity
## adults         234  0.5480094 0.03392596
## saplings       193  0.4519906 0.02798167
## 
## Window: rectangle = [1.22493, 80.43507] x [-1.64345, 85.43345] units
##                     (79.21 x 87.08 units)
## Window area = 6897.37 square units</code></pre>
<p><img src="Solution_cluster_files/figure-html/s_3_plot_trd_data%20-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Also, we need to implement the O-ring statistic as before.</p>
<pre class="r"><code>  Oest &lt;- function(input,r = NULL,
                   correction = &quot;Ripley&quot;, divisor = &quot;d&quot;, ...){
    
    p_fct &lt;- pcf(input,  r = r,
                 correction = correction, divisor = divisor, ...)
    
    lambda &lt;- intensity(unmark(input))
    
    eval.fv(p_fct*lambda)
  }</code></pre>
<p>We calculate the O-ring statistic for the adult trees only, using <code>envelope()</code> and the null model of ‘CSR’.</p>
<pre class="r"><code>  adults &lt;- subset.ppp(hemlock_ppp, marks == &quot;adults&quot;, drop = TRUE)
  
  envelopes_adults_homo &lt;- envelope(Y = adults, fun = Oest,
                                    r = seq(from = 0, to = 45, by = 0.5), 
                                    nsim = 199, rank = 5)</code></pre>
<p><img src="Solution_cluster_files/figure-html/s_3_plot_oring_adults-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="exercise-2-2" class="section level3">
<h3>Exercise 2</h3>
<p><strong>Task:</strong> Getzin et al. (2008) show that the study area is heterogeneous. We are going to account for this heterogeneity by fitting a heterogeneous Poisson processes.</p>
<p>Firstly, we need to get the intensity <span class="math inline">\(\lambda(xy)\)</span> at every point of the observation window. The result is a <code>im</code> (pixel image) object.</p>
<pre class="r"><code>  lambda_xy &lt;- density(x = adults)

  class(lambda_xy)
## [1] &quot;im&quot;</code></pre>
<p><img src="Solution_cluster_files/figure-html/s_3_plot_lambda-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now, we can simulate heterogeneous point patterns following the intensity of the pattern. Therefore, we use <code>rpoispp()</code> and specify the argument <code>lambda</code> with the created <code>im</code> object. Also, we specify the number of simulated patterns (<code>nsim</code>). The result is a list with heterogeneous point patterns. If you plot one realization of the simulated data, you can see how the random points ‘follow’ the intensity.</p>
<pre class="r"><code>  simulated_heterogenous_pattern &lt;- rpoispp(lambda = lambda_xy, nsim = 199)</code></pre>
<p><img src="Solution_cluster_files/figure-html/s_3_plot_hetero-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now, we can use the simulated point patterns as input for <code>envelope()</code> to create simulation envelopes with the null model of a heterogeneous Poisson process.</p>
<pre class="r"><code>  envelopes_adults_hetero &lt;- envelope(Y = adults, fun = Oest,
                                      r = seq(from = 0, to = 45, 
                                              by = 0.5), 
                                      nsim = 199, rank = 5, 
                                      simulate = simulated_heterogenous_pattern)</code></pre>
<p><img src="Solution_cluster_files/figure-html/s_3_plot_sim_hetero-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>There is a wrapper around these function in <a href="https://r-spatialecology.github.io/onpoint/"><code>onpoint</code></a> to simulate a heterogenous Poisson process as null model (see <code>?simulate_heterogenous_pattern</code>).</p>
<p>Alternativly, <code>spatstat</code> can calculated the inhomogenous pair-correlation function and consider the heterogneous plot conditions while estimating the pair-correlation function.</p>
<pre class="r"><code>  envelopes_adults_inhomo &lt;- envelope(Y = adults, fun = pcfinhom, 
                                      divisor = &quot;d&quot;,
                                      correction = &quot;Ripley&quot;,
                                      r = seq(from = 0, to = 45, by = 0.5),
                                      nsim = 199, rank = 5)</code></pre>
<p><img src="Solution_cluster_files/figure-html/s_3_plot_envelopes_hetero-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>References</strong>:</p>
<p>Baddeley, A., Rubak, E., Turner, R., 2015. Spatial point patterns: Methodology and applications with R. Chapman and Hall/CRC Press, London.</p>
<p>Getzin, S., Dean, C., He, F., Trofymow, J.A., Wiegand, K., Wiegand, T., 2006. Spatial patterns and competition of tree species in a Douglas fir chronosequence on Vancouver Island. Ecography, 29, 671-682.</p>
<p>Getzin, S., Wiegand, T., Wiegand, K., He, F., 2008. Heterogeneity influences spatial patterns and demographics in forest stands. J. Ecol. 96, 807-820.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
